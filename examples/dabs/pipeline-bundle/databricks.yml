# databricks.yml - Main bundle configuration

bundle:
  name: data-pipeline-bundle

include:
  - resources/*.yml

variables:
  catalog:
    description: Target catalog for tables
    default: dev
  
  warehouse_id:
    description: SQL Warehouse ID for DLT pipelines
  
  notification_email:
    description: Email for job notifications
    default: data-alerts@company.com

targets:
  # ============ Development ============
  dev:
    mode: development
    default: true
    workspace:
      host: ${DATABRICKS_HOST_DEV}
    variables:
      catalog: dev
    resources:
      jobs:
        daily_etl_pipeline:
          name: "[DEV] Daily ETL Pipeline"

  # ============ Staging ============
  staging:
    mode: development
    workspace:
      host: ${DATABRICKS_HOST_STAGE}
    variables:
      catalog: stage
    resources:
      jobs:
        daily_etl_pipeline:
          name: "[STAGE] Daily ETL Pipeline"

  # ============ Production ============
  prod:
    mode: production
    workspace:
      host: ${DATABRICKS_HOST_PROD}
      root_path: /Shared/.bundle/prod/${bundle.name}
    run_as:
      service_principal_name: sp-prod-pipelines
    variables:
      catalog: prod
    resources:
      jobs:
        daily_etl_pipeline:
          name: "Daily ETL Pipeline"
